<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ARMY Training Camp</title>
    <script src="songs.js"></script>
    <style>
        body { background: #111; color: #fff; font-family: sans-serif; padding: 20px; text-align: center; }
        h1 { color: #AB46D2; }
        #progress-container { width: 100%; background: #333; height: 20px; border-radius: 10px; margin: 20px 0; overflow: hidden; }
        #progress-bar { width: 0%; height: 100%; background: #AB46D2; transition: width 0.3s; }
        .song-list { text-align: left; max-width: 400px; margin: 0 auto; }
        .song-item { padding: 12px; border-bottom: 1px solid #333; display: flex; align-items: center; justify-content: space-between; }
        .song-info { display: flex; align-items: center; }
        .song-item input { margin-right: 15px; transform: scale(1.5); accent-color: #AB46D2; }
        .song-item input:disabled { opacity: 0.6; cursor: not-allowed; }
        .count-tag { font-size: 12px; color: #AB46D2; font-weight: bold; }
        
        #btn-cert { background: #444; color: #888; border: none; padding: 15px; border-radius: 50px; width: 100%; margin-top: 20px; font-size: 18px; }
        #btn-cert.unlocked { background: linear-gradient(45deg, #AB46D2, #5a189a); color: white; cursor: pointer; box-shadow: 0 0 20px #AB46D2; }
        
        #certificate-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); flex-direction: column; justify-content: center; align-items: center; z-index: 999; }
        #cert-card { background: #000; border: 4px solid #AB46D2; padding: 20px; border-radius: 15px; width: 80%; text-align: center; }
        .close-btn { margin-top: 20px; background: transparent; border: 1px solid #fff; color: white; padding: 5px 20px; border-radius: 20px; }
    </style>
</head>
<body>
    <h1>ğŸ’œ ç‰¹è¨“ä¸­å¿ƒ</h1>
    <a href="index.html" style="color:#888; text-decoration:none;">â† å›é¦–é </a>
    <br><br>
    <input type="text" id="army-name" placeholder="è¼¸å…¥æš±ç¨±" style="padding:10px; border-radius:5px; border:1px solid #AB46D2; background:#222; color:#fff;">
    
    <div id="progress-container"><div id="progress-bar"></div></div>
    <div id="progress-text">è¼‰å…¥ä¸­...</div>

    <div id="dynamic-song-list" class="song-list"></div>

    <button id="btn-cert" disabled>ğŸ”’ é ˜å–è­‰æ›¸</button>

    <div id="certificate-overlay">
        <div id="cert-card">
            <h2>CERTIFICATE</h2>
            <div style="font-size:40px;">ğŸ…</div>
            <p>This certifies that</p>
            <h1 id="cert-name" style="color:#AB46D2;">ARMY</h1>
            <p>Has completed the training.</p>
            <p id="cert-date" style="font-size:12px; color:#888;"></p>
        </div>
        <p style="color:#fff;">è«‹æˆªåœ–åˆ†äº« âœ¨</p>
        <button class="close-btn" onclick="document.getElementById('certificate-overlay').style.display='none'">é—œé–‰</button>
    </div>

    <script>
        const songListContainer = document.getElementById('dynamic-song-list');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const btnCert = document.getElementById('btn-cert');
        const nameInput = document.getElementById('army-name');

        // 1. å‹•æ…‹ç”Ÿæˆæ­Œæ›²æ¸…å–®
        function renderSongs() {
            songListContainer.innerHTML = '';
            
            // éæ­· songs.js è£¡çš„ songLibrary
            Object.keys(songLibrary).forEach((key, index) => {
                const song = songLibrary[key];
                // æŠ“å–è©²é¦–æ­Œæ›²çš„ç·´ç¿’æ¬¡æ•¸
                const count = parseInt(localStorage.getItem(`${key}_count`) || '0');
                const isMaster = count >= 3;

                const item = document.createElement('div');
                item.className = 'song-item';
                item.innerHTML = `
                    <div class="song-info">
                        <input type="checkbox" id="check-${key}" ${isMaster ? 'checked' : ''} disabled>
                        <span>${index + 1}. ${song.title}</span>
                    </div>
                    <div class="count-tag">
                        ${isMaster ? 'âœ… å¤§å¸« (3/3)' : `ğŸ”’ ç´¯ç©: ${count}/3`}
                    </div>
                `;
                songListContainer.appendChild(item);
            });
            updateUI();
        }

        function updateUI() {
            const allCheckboxes = document.querySelectorAll('input[type="checkbox"]');
            const checked = document.querySelectorAll('input:checked').length;
            const total = allCheckboxes.length;
            const percent = total === 0 ? 0 : (checked / total) * 100;
            
            progressBar.style.width = percent + "%";
            progressText.innerText = `å·²å®Œæˆ ${checked} / ${total}`;
            
            if (percent === 100 && total > 0) {
                btnCert.disabled = false;
                btnCert.classList.add('unlocked');
                btnCert.innerText = "ğŸ† é ˜å–è­‰æ›¸";
            } else {
                btnCert.disabled = true;
                btnCert.classList.remove('unlocked');
                btnCert.innerText = "ğŸ”’ é ˜å–è­‰æ›¸";
            }
            
            // å­˜æª”åå­—
            localStorage.setItem('army_name', nameInput.value);
        }

        // åˆå§‹åŒ–
        nameInput.value = localStorage.getItem('army_name') || "";
        nameInput.addEventListener('input', updateUI);
        
        // åŸ·è¡Œæ¸²æŸ“
        if (typeof songLibrary !== 'undefined') {
            renderSongs();
        } else {
            progressText.innerText = "éŒ¯èª¤ï¼šç„¡æ³•è®€å–æ­Œæ›²åº«";
        }

        btnCert.addEventListener('click', () => {
            document.getElementById('cert-name').innerText = nameInput.value || "ARMY";
            document.getElementById('cert-date').innerText = new Date().toLocaleDateString();
            document.getElementById('certificate-overlay').style.display = 'flex';
        });
    </script>
</body>
</html>
